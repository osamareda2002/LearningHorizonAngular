<div class="books-container">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo-container">
      <img
        src="assets/logo.png"
        alt="Learning Horizon"
        (click)="goBackToHome()"
        class="sidebar-logo"
        style="cursor: pointer"
      />
    </div>

    <nav class="sidebar-nav">
      <a routerLink="/home" class="nav-item">
        <i class="bi bi-grid"></i>
        <span>Home</span>
      </a>
      <a routerLink="/material" class="nav-item">
        <i class="bi bi-collection"></i>
        <span>Material</span>
      </a>
      <a routerLink="/books" class="nav-item active">
        <i class="bi bi-book"></i>
        <span>Books</span>
      </a>
      <a *ngIf="isAdmin" routerLink="/add" class="nav-item">
        <i class="bi bi-plus-circle"></i>
        <span>Add Content</span>
      </a>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- User Navbar -->
    <div class="user-navbar">
      <h2 class="page-title">Books Library</h2>
      <div class="user-menu">
        <span class="user-name">{{ userName }}</span>
        <div class="dropdown">
          <button class="dropdown-toggle" (click)="toggleDropdown()">
            <i class="bi bi-chevron-down"></i>
          </button>
          <div class="dropdown-menu" [class.show]="isDropdownOpen">
            <a *ngIf="!isLoggedIn" (click)="handleAuth()">Login</a>
            <a *ngIf="isLoggedIn" (click)="handleAuth()">Logout</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Search Section -->
    <div class="search-section">
      <div class="search-box">
        <i class="bi bi-search"></i>
        <input
          type="text"
          [(ngModel)]="searchQuery"
          (input)="onSearch()"
          placeholder="Search books by title or description..."
        />
      </div>
    </div>

    <!-- Books Section -->
    <section class="books-section" *ngIf="!loading; else loadingTemplate">
      <div *ngIf="filteredBooks.length > 0; else noBooks">
        <div class="books-list">
          <div class="book-card" *ngFor="let book of filteredBooks">
            <div class="book-cover">
              <img [src]="book.coverImage" [alt]="book.title" />
            </div>

            <div class="book-info">
              <h3 class="book-title">{{ book.title }}</h3>
              <p class="book-description">{{ book.description }}</p>
            </div>

            <div class="book-actions">
              <a
                *ngIf="book.readUrl"
                [href]="book.readUrl"
                target="_blank"
                class="book-action-link"
              >
                <i class="bi bi-book"></i> Read
              </a>

              <a
                *ngIf="book.visitUrl"
                [href]="book.visitUrl"
                target="_blank"
                class="book-action-link"
              >
                <i class="bi bi-box-arrow-up-right"></i> Visit
              </a>

              <a
                *ngIf="book.downloadUrl"
                [href]="book.downloadUrl"
                target="_blank"
                class="book-action-link"
              >
                <i class="bi bi-download"></i> Download
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Loading Template -->
    <ng-template #loadingTemplate>
      <div class="loading-container">
        <div class="spinner"></div>
        <p>Loading books...</p>
      </div>
    </ng-template>

    <!-- No Books Template -->
    <ng-template #noBooks>
      <div class="no-books">
        <i class="bi bi-emoji-frown"></i>
        <p>No books found.</p>
      </div>
    </ng-template>
  </main>
</div>
